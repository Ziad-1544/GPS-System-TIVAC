#include <stdbool.h>

// Global variables
int CurrentLED = 0;
int CurrentMode = 0;

// switch and hardware functions
int isSW1Pressed(void);  // returns 1 if SW1 is pressed
int isSW2Pressed(void);  // returns 1 if SW2 is pressed
void LED_On(int led);    // turn on LED by index
void LED_Off(int led);   // turn off LED by index
void LED_OffAll(void);   // turn off all LEDs
void LCD_Print(char* text); // display text
void DelayMs(int ms);    // millisecond delay

// Mode Functions

void ManualMode(void) {
    if (isSW2Pressed()) {
    	LED_OffAll();
        if (CurrentLED == 0) {
            LED_On(0);
            LCD_Print("Manual Mode":"LED 1: ON"); // (,)is used with two arguments but declared function void LCD_Print(char* text) takes only one so i will use (:)
        }
	    else if (CurrentLED == 1) {
            LED_On(1);
            LCD_Print("Manual Mode":"LED 2: ON");
        }
		else if (CurrentLED == 2) {
            LED_On(2);
            LCD_Print("Manual Mode":"LED 3: ON");
        }
        
        CurrentLED = (CurrentLED + 1) % 3; // Move to the next LED
}

void AutoToggleMode(void) {
	static bool paused = false;
    if (isSW2Pressed()) {
        paused = !paused;
    }

    if (paused) {
        LCD_Print("Auto Toggle Mode" : "Status: Paused");
        return;
    }

    LED_OffAll();
    if (CurrentLED == 0) LED_On(0);
    else if (CurrentLED == 1) LED_On(1);
    else if (CurrentLED == 2) LED_On(2);
    // Case 3 means all off
    LCD_Print("Auto Toggle Mode" : "Status: Runing");

    DelayMs(500);
    CurrentLED = (CurrentLED + 1) % 4;
}

void BlinkMode(void) {
	int delayValues[3] = {1000, 500, 250}; // array[Slow, Medium, Fast]
    const char* speedLabels[3] = {"Slow", "Medium", "Fast"};
	static int BlinkSpeed = 0;
    if (isSW2Pressed()) {
        BlinkSpeed = (BlinkSpeed + 1) % 3;  // Cycle through blink speeds
    }
    // Blink all LEDs together
    LED_On(0);
    LED_On(1);
    LED_On(2);
    DelayMs(delayValues[BlinkSpeed]);
    LED_Off(0);
    LED_Off(1);
    LED_Off(2);
    DelayMs(delayValues[BlinkSpeed]);

    char text[32];
    sprintf(text, "Blink Mode : speed: %s", speedLabels[BlinkSpeed]);
    LCD_Print(text);

void CounterMode(void) {
    static int count = 0;
    if (count == 0) LED_OffAll();
    if (count == 1) LED_On(0);
    if (count == 2) LED_On(1); 
    if (count == 3) { LED_On(0); LED_On(1);	}
    if (count == 4) LED_On(2);
    if (count == 5) { LED_On(0); LED_On(2);	}
    if (count == 6) { LED_On(1); LED_On(2);	}
    if (count == 7) { LED_On(0); LED_On(1); LED_On(2); }
        
    if (isSW2Pressed()) {
        count = (count+1) % 8 ;
        char buffer[32];
        sprintf(buffer, "Counter Mode : counter: %d", count);
        LCD_Print(buffer);
    }
}

//  Main 
int main(void) {
    while (1) {
        if (isSW1Pressed()) {
            CurrentMode = (CurrentMode + 1) % 4;
        }

        switch (CurrentMode) {
            case 0: ManualMode(); break;
            case 1: AutoToggleMode(); break;
            case 2: BlinkMode(); break;
            case 3: CounterMode(); break;
        }
    }
}

